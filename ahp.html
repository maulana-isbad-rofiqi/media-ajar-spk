<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modul AHP - Profesional</title>
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/3067/3067260.png" type="image/png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav class="navbar glass-nav sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold text-white" href="index.html">
                <i class="fas fa-chevron-left me-2"></i> Kembali
            </a>
            <span class="text-white fw-bold">Modul AHP</span>
        </div>
    </nav>

    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="glass-card p-4 border-danger mb-4">
                    <h5 class="fw-bold mb-4 text-white text-center"><i class="fas fa-sitemap me-2 text-danger"></i>Matriks Perbandingan Berpasangan</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-dark table-bordered text-center align-middle" style="background: transparent;">
                            <thead class="text-danger">
                                <tr><th>Kriteria</th><th>Harga</th><th>Kualitas</th><th>Layanan</th></tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="fw-bold text-white-50">Harga</td>
                                    <td><input type="text" class="form-control glass-input text-center" value="1" disabled></td>
                                    <td><input type="number" id="k1_k2" class="form-control glass-input text-center" value="3" onchange="autoFill()"></td>
                                    <td><input type="number" id="k1_k3" class="form-control glass-input text-center" value="5" onchange="autoFill()"></td>
                                </tr>
                                <tr>
                                    <td class="fw-bold text-white-50">Kualitas</td>
                                    <td><input type="text" id="k2_k1" class="form-control glass-input text-center text-white-50" value="0.33" disabled></td>
                                    <td><input type="text" class="form-control glass-input text-center" value="1" disabled></td>
                                    <td><input type="number" id="k2_k3" class="form-control glass-input text-center" value="3" onchange="autoFill()"></td>
                                </tr>
                                <tr>
                                    <td class="fw-bold text-white-50">Layanan</td>
                                    <td><input type="text" id="k3_k1" class="form-control glass-input text-center text-white-50" value="0.2" disabled></td>
                                    <td><input type="text" id="k3_k2" class="form-control glass-input text-center text-white-50" value="0.33" disabled></td>
                                    <td><input type="text" class="form-control glass-input text-center" value="1" disabled></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="d-grid mt-3">
                        <button onclick="hitungAHP()" class="btn btn-danger btn-lg fw-bold shadow-lg">
                            <i class="fas fa-check-circle me-2"></i>Cek Konsistensi
                        </button>
                    </div>
                </div>

                <div id="hasil-container" class="row d-none animate__animated animate__fadeInUp">
                    <div class="col-md-6">
                        <div class="glass-card p-4 h-100">
                            <h6 class="text-danger fw-bold mb-3">Bobot Prioritas</h6>
                            <ul class="list-group list-group-flush bg-transparent" id="list-bobot"></ul>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="glass-card p-4 h-100 text-center">
                            <h6 class="text-danger fw-bold mb-3">Status Konsistensi (CR)</h6>
                            <h2 id="nilai-cr" class="fw-bold text-white display-4 my-3"></h2>
                            <div id="status-cr"></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        function autoFill() {
            let k1k2 = parseFloat(document.getElementById('k1_k2').value);
            let k1k3 = parseFloat(document.getElementById('k1_k3').value);
            let k2k3 = parseFloat(document.getElementById('k2_k3').value);
            document.getElementById('k2_k1').value = (1/k1k2).toFixed(3);
            document.getElementById('k3_k1').value = (1/k1k3).toFixed(3);
            document.getElementById('k3_k2').value = (1/k2k3).toFixed(3);
        }

        function hitungAHP() {
            let btn = document.querySelector('button');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Menghitung...';
            btn.disabled = true;

            setTimeout(() => {
                let mat = [
                    [1, parseFloat(document.getElementById('k1_k2').value), parseFloat(document.getElementById('k1_k3').value)],
                    [parseFloat(document.getElementById('k2_k1').value), 1, parseFloat(document.getElementById('k2_k3').value)],
                    [parseFloat(document.getElementById('k3_k1').value), parseFloat(document.getElementById('k3_k2').value), 1]
                ];

                let totalCol = [0, 0, 0];
                for(let i=0; i<3; i++) for(let j=0; j<3; j++) totalCol[j] += mat[i][j];

                let bobot = [0, 0, 0];
                for(let i=0; i<3; i++) {
                    let sum = 0;
                    for(let j=0; j<3; j++) sum += mat[i][j] / totalCol[j];
                    bobot[i] = sum / 3;
                }

                let lambdaMax = 0;
                for(let i=0; i<3; i++) lambdaMax += totalCol[i] * bobot[i];

                let CI = (lambdaMax - 3) / 2;
                let CR = CI / 0.58;

                document.getElementById('hasil-container').classList.remove('d-none');
                
                let htmlBobot = '';
                let kriteria = ['Harga', 'Kualitas', 'Layanan'];
                for(let i=0; i<3; i++) {
                    htmlBobot += `<li class="list-group-item d-flex justify-content-between bg-transparent text-white border-secondary">${kriteria[i]} <span class="badge bg-danger">${(bobot[i]*100).toFixed(1)}%</span></li>`;
                }
                document.getElementById('list-bobot').innerHTML = htmlBobot;
                document.getElementById('nilai-cr').innerText = CR.toFixed(4);

                let statusBox = document.getElementById('status-cr');
                if(CR < 0.1) {
                    statusBox.innerHTML = '<span class="badge bg-success px-3 py-2 fs-6">KONSISTEN (Valid)</span>';
                    Swal.fire({ title: 'Konsisten', text: 'Bobot valid digunakan.', icon: 'success', background: '#1e293b', color: '#fff' });
                } else {
                    statusBox.innerHTML = '<span class="badge bg-warning text-dark px-3 py-2 fs-6">TIDAK KONSISTEN</span>';
                    Swal.fire({ title: 'Tidak Konsisten', text: 'Cek kembali input perbandingan.', icon: 'error', background: '#1e293b', color: '#fff' });
                }
                
                btn.innerHTML = '<i class="fas fa-check-circle me-2"></i>Cek Konsistensi';
                btn.disabled = false;
            }, 800);
        }
    </script>
</body>
</html>
